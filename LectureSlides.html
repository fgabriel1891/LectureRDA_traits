<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Relating species characteristics to their environmnent - RDA</title>
    <meta charset="utf-8" />
    <meta name="date" content="2022-05-04" />
    <script src="assets/header-attrs-2.9/header-attrs.js"></script>
    <link href="assets/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="R.css" type="text/css" />
    <link rel="stylesheet" href="fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Relating species characteristics to their environmnent - RDA
### 
### 05/04/2022

---





# About me: Gabriel Muñoz  

**Quantitative Ecologist**


**Ph.D. candidate** in Biological Sciences @Concordia University

.tiny[**M.Sc. Biology**, *track* Ecology and Evolution @University of Amsterdam, NL]

.tiny[**B.Sc. Biology**  @Universidad San Francisco de Quito, EC]



&lt;img src="images/Lab Logo.png" width="30%" style="display: block; margin: auto;" /&gt;





---
# Learning objectives:

&lt;br&gt;


- **The diversity of species characteristics  in ecological communities (Functional diversity) **

- **Quantify changes in functional diversity along environmental gradients** 


&lt;br&gt;

## Lecture structure 

1) Functional Ecology (~20min)

2) Redundancy Analysis (RDA) (~15min)

3) Case study (~30 min)

&lt;br&gt;

.alert[You can stop me anytime for questions]




---
# Important note

.alert[Your feedback is important to me]


https://www.cognitoforms.com/BiologyCU/BIOL801StudentLectureFeedback


mail: gabriel.munoz@concordia.ca


---
class: inverse, center, middle
# 1. Functional Ecology


---
# Biodiversity: The diversity of lifeforms 


&lt;img src="images/Biodiversity-1-1024x576.png" width="80%" style="display: block; margin: auto;" /&gt;


---
# The diversity of lifeforms and climates 

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/Cuyabeno.jpeg" alt=" Flooded forests in Cuyabeno, Sucumbios Ecuador" width="80%" /&gt;
&lt;p class="caption"&gt; Flooded forests in Cuyabeno, Sucumbios Ecuador&lt;/p&gt;
&lt;/div&gt;
---
# The diversity of lifeforms and climates 


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/CEiboManabi.jpeg" alt="Ceibo-Manabí, Ecuador" width="80%" /&gt;
&lt;p class="caption"&gt;Ceibo-Manabí, Ecuador&lt;/p&gt;
&lt;/div&gt;
---
# The diversity of lifeforms and climates  
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/lengaPatagonia.JPG" alt="Lenga forest, El Chalten, Patagonia, Argentina" width="80%" /&gt;
&lt;p class="caption"&gt;Lenga forest, El Chalten, Patagonia, Argentina&lt;/p&gt;
&lt;/div&gt;


---
# The diversity of lifeforms and climates  
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/Atacama.JPG" alt="Atacama desert, Chile" width="80%" /&gt;
&lt;p class="caption"&gt;Atacama desert, Chile&lt;/p&gt;
&lt;/div&gt;


---
#  Climate limits biodiversity


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/WhittkerPlot.png" alt="Whittaker plot" width="50%" /&gt;
&lt;p class="caption"&gt;Whittaker plot&lt;/p&gt;
&lt;/div&gt;




---
# The dimensions of biodiversity

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /&gt;




---
# Funtional diversity: Species traits 

.alert[Traits: species unique characteristics]

- **Traits that allows species to live where they live**

- Traits that allow species to interact with others

- Traits that influence the impact of a species in the ecosystem

&lt;img src="images/Mammals.png" width="40%" style="display: block; margin: auto;" /&gt;




---
# The ecological niche 

.alert[Niche: The relative positioning of species in a ecological space]

- Grinnellian niche view: Species environmental tolerances (physiological requirements)


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/drosophilagrowth.jpeg" alt="Drosophila growth, Bozinovic et al., 2011" width="60%" /&gt;
&lt;p class="caption"&gt;Drosophila growth, Bozinovic et al., 2011&lt;/p&gt;
&lt;/div&gt;


---
# The ecological niche 

.alert[Niche: The relative positioning of species in a ecological space]


- Eltonian niche view : Biotic dimensions (species interactions)


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/radiation.jpeg" alt="Finch radiation" width="80%" /&gt;
&lt;p class="caption"&gt;Finch radiation&lt;/p&gt;
&lt;/div&gt;

---
# The ecological niche 

.alert[Niche: The relative positioning of species in a ecological space]

- Hutchinson: n-dimensional hypervolume (both Env + Int)

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/hutch.png" alt="High dimensional volume" width="60%" /&gt;
&lt;p class="caption"&gt;High dimensional volume&lt;/p&gt;
&lt;/div&gt;


.alert[!Neutral theory of biodiversity: All species are equivalent]


---
#  Distribution of ecological niches drive the composition of biotas


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/WhittkerPlot.png" alt="Whittaker plot" width="50%" /&gt;
&lt;p class="caption"&gt;Whittaker plot&lt;/p&gt;
&lt;/div&gt;


---
# Niche-based assembly processes 


.alert[.small[Ecological communities: 
Sets of interacting species within a
considerable area of space and period of time  ]]

.alert[Deterministic processes]

- Species sorting / Limiting similarity principle 

- Fundamental and realized niches


&lt;img src="images/sortingCExclusion.png" width="50%" style="display: block; margin: auto;" /&gt;




---
# Funtional diversity: a driver of innovation in Ecology 


Species functional traits --&gt; ** Phenotypes reflecting species adaptations to their ecological niches**

- Allow testing more mechanistic hypothesis in community assembly 

- Relate species functions to climatic variation 

- Identify transition zones 

- Predict consequences of global climate changes in biodiversity

---
# Functional diversity: The knowledge gap

- Global trait databases

- Species responses to global change


https://www.try-db.org/TryWeb/Home.php



&lt;img src="images/plantTraits.png" style="display: block; margin: auto;" /&gt;


---
# Quantifying functional diversity: Functional position (identity)


`$$CWM = \dfrac{\sum_{i = 1}^{n} (x_i \times w_i)}{ \sum_{i = 1}^{n} (w_i)}$$`


&lt;img src="images/CWM.png" width="90%" style="display: block; margin: auto;" /&gt;

---
# Quantifying functional diversity: Functional range


`$$T_{max} - T_{min}$$` 


&lt;img src="images/range.png" width="90%" style="display: block; margin: auto;" /&gt;


---
# Quantifying functional diversity: Functional dispersion 

$$ SD(\{d_i,\cdots, d_i\}) $$ 

&lt;img src="images/TraitDis.png" width="90%" style="display: block; margin: auto;" /&gt;


---
# Functional diversity changes along gradients 

- Inferring process from patterns

&lt;img src="images/TestHyp.png" width="80%" style="display: block; margin: auto;" /&gt;




---
class: inverse, center, middle

## Redundancy analysis (RDA)


---
# Ordinations

- Useful to represent the variance-covariance of multidimensional datasets

- Techniques to reduce dataset dimensionality into fewer synthetic variables 

- Descriptive of data-structure (Unconstrained)

- e.g. Principal Component Analysis 


.pull-left[
&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-20-1.png" width="360" style="display: block; margin: auto;" /&gt;

]


.pull-right[
&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-21-1.png" width="80%" style="display: block; margin: auto;" /&gt;

]


---
# Canonical Analysis


- Method first described by Rao (1964)
 
 
&lt;img src="images/Rao.jpeg" width="70%" style="display: block; margin: auto;" /&gt;


---
# Canonical Analysis


- Finds relationships between response and predictor matrices 

- *Y* = Sites x Species | *X* = Sites x Environmental variables 

- RDA | CCA 

&lt;img src="images/SITES_ENVAR.png" width="60%" style="display: block; margin: auto;" /&gt;


---
#  Redundancy analysis (RDA)


- RDA - Redundancy analysis:

- Combines multivariate linear regression and ordinations 

- How much variance of in Y can be explained by the variance in X

&lt;img src="images/MultivariateRe.png" width="60%" style="display: block; margin: auto;" /&gt;

---
# Redundancy analysis: Important considerations

- Independence of observations 

- Linear relationships between Y~X 

- No multicolinearity 

  - Plots and variance inflation factors, evaluate the need for transformation 
  - Rare species are removed 

- (# sites &gt;&gt; # predictors) 

---
# Redundancy analysis: Underlying mechanics 

- 2 step process 

- First multivariate regression, then PCA on fitted values 

- Fits Y table to the linear combination of environmental variables 

&lt;img src="images/constrained_ord_diagram.png" width="30%" style="display: block; margin: auto;" /&gt;

---
# Redundancy analysis: Interpreting results

&lt;img src="images/triplot.png" width="60%" style="display: block; margin: auto;" /&gt;


---
# Redundancy analysis: Important technical questions

- How many axes are required? 

- Hypothesis test, by permutations?

- How many variables are needed?

- How important are my different variables? 

- Which scaling report? 

---
class: inverse, center, middle

## Case study: Relating species characteristics to their environment-Redundancy analysis (RDA)

---
# Case study: The geography of China


&lt;img src="images/ChinaGeogrp.jpeg" width="80%" style="display: block; margin: auto;" /&gt;

---
# Case study: The China Plant Trait Database


&lt;img src="images/ChinaPlantTrait.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Case study: The China Plant Trait Database





```
#  [1] "ID"              "SAMPLE.ID"       "Average.LA..m2." "SLA..m2.kg."    
#  [5] "LMA..kg.m2."     "LDMC..mg.g."     "Cmass..g.kg."    "Nmass..g.kg."   
#  [9] "Pmass..g.kg."    "Kmass..g.kg."    "Narea..g.m2."    "Parea..g.m2."   
# [13] "Karea..g.m2."    "d13C.12C"        "d15N.14N"
#  [1] "Site.ID"           "Site.Name"         "Latitude"         
#  [4] "Longitude"         "Elevation"         "Collection.month" 
#  [7] "Collection.year"   "Source"            "Sampling.strategy"
# [10] "References"
```


&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-31-1.png" width="360" style="display: block; margin: auto;" /&gt;


---
# Case study: The China Plant Trait Database

How many species are in the dataset? 

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-32-1.png" width="360" style="display: block; margin: auto;" /&gt;


---
# Case study: The China Plant Trait Database


```
#   ID Site.ID Original.Genus Original.Species ACCEPTED.GENUS ACCEPTED.SPECIES
# 1  1       1         Allium        senescens         Allium        senescens
# 2  2       1      Artemisia          frigida      Artemisia          frigida
# 3  3       1      Artemisia         sacrorum      Artemisia         gmelinii
# 5  5       1     Astragalus       galactites     Astragalus       galactites
# 6  6       1     Astragalus      scaberrimus     Astragalus      scaberrimus
#   SPECIES.ID SAMPLE.ID Average.LA..m2. SLA..m2.kg. LMA..kg.m2. LDMC..mg.g.
# 1       SP81         1      2.0010e-04    13.71253  0.07348235    353.7245
# 2      SP142         2      1.0005e-05    24.32378  0.04121057    457.2960
# 3      SP144         3      5.3360e-06    21.94605  0.04580574    336.3854
# 5      SP176         5      1.0672e-04          NA          NA          NA
# 6      SP182         6      6.6700e-05    12.14942  0.08294345    344.2806
#   Cmass..g.kg. Nmass..g.kg. Pmass..g.kg. Kmass..g.kg. Narea..g.m2. Parea..g.m2.
# 1           NA           NA           NA           NA           NA           NA
# 2      544.229     20.31644     1.407591    16.522977    0.8352501   0.05786894
# 3      459.178     21.10508     1.602951    18.167811    0.9616803   0.07304054
# 5           NA           NA           NA           NA           NA           NA
# 6      332.739     25.87347     1.266567     9.725709    2.1296051   0.10424916
#   Karea..g.m2. d13C.12C d15N.14N
# 1           NA       NA       NA
# 2    0.6792932  -27.604   -2.863
# 3    0.8278397  -26.892   -3.057
# 5           NA       NA       NA
# 6    0.8005080  -25.749   -2.167
```


---
# Building the Y matrix: Handling missing data

Do we have missing data? 


```
# [1] "##### How many NA per trait? ###### "
#       Average.LA..m2. SLA..m2.kg. LMA..kg.m2. LDMC..mg.g. Cmass..g.kg.
# FALSE            1018        1034        1034         900          771
# TRUE              195         179         179         313          442
#       Nmass..g.kg. Pmass..g.kg. Kmass..g.kg. Narea..g.m2. Parea..g.m2.
# FALSE          922          666          619          918          664
# TRUE           291          547          594          295          549
#       Karea..g.m2. d13C.12C d15N.14N
# FALSE          617      469      381
# TRUE           596      744      832
```


---
# Building the Y matrix: Variable standardization


Range normalization

`\(\frac{x-x_{min}}{x_{max} - x_{min}}\)`


Mean + variance scaling 

`\(\frac{x-mean}{sd}\)`



&lt;img src="images/normalizeStandardize.png" width="60%" style="display: block; margin: auto;" /&gt;



---
# Building the Y matrix: Variable standardization

Range normalization


&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-36-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
# Building the Y matrix: Variable standardization

Mean-variance scaling


&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-37-1.png" width="60%" style="display: block; margin: auto;" /&gt;




---
# Building the Y matrix: Site-trait matrix 


&lt;img src="images/SiteTraitMat.png" width="90%" style="display: block; margin: auto;" /&gt;


.alert[What to do with differences in species richness among sites?]


---
# Building the Y matrix: Site-trait matrix 


How many species above a richness threshold? 

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-40-1.png" width="360" style="display: block; margin: auto;" /&gt;



---
# Building the Y matrix: Site-trait matrix 


&lt;img src="images/SiteTraitMat2.png" width="90%" style="display: block; margin: auto;" /&gt;



---
# Building the Y matrix: Site-trait matrix 



```r


spTab2 &lt;- vegan::decostand(spTab2, method = "hellinger")
# community weighted means 
cwm.tab &lt;- prop.table(as.matrix(spTab2),2) %*% as.matrix(scale(spTrait2))
# Dimensions of Sites x traits #
dim(cwm.tab)
# [1] 83  6
```

---
# Building the X matrix: Environmental variable matrix 



```
#   Site.ID  MAT....C. MI..unitless. alpha..unitless. GDD0...C.days. mGDD0....C.
# 1       1 -0.5246671  -0.696001445       -0.5344169     -0.6404428  -0.5053884
# 2       2 -0.5131194  -0.744489595       -0.6275897     -0.5746852  -0.3080644
# 3       3 -0.3334891  -0.094307592        0.4396623     -0.4680040  -0.3276616
# 4       4 -0.4455442   0.040136822        0.6598889     -0.6107659  -0.6165521
# 5       5 -0.5138322  -0.001739307        0.6048323     -0.6824859  -0.7118353
# 6       6 -0.4374181  -0.017167354        0.5794215     -0.6229639  -0.6297296
#   PAR0..mol.photon.m.2. mPAR0..mol.photon.m.2. Prec.Timing..month.from.Jan1st.
# 1            -0.3280314              0.8678624                       0.1804618
# 2            -0.3795455              0.8322221                       0.1501914
# 3            -0.9143590             -0.4281475                       0.1143916
# 4            -0.9878796             -0.4047730                       0.1316360
# 5            -0.9956074             -0.2561948                       0.1248712
# 6            -0.9537671             -0.3263182                       0.1125261
#   Prec.Seasonality..unitless.   MMP..mm.   MAP..mm.
# 1                  0.93189191 -0.6594620 -0.6594516
# 2                  1.08839665 -0.6971349 -0.6971410
# 3                  0.14655210 -0.3346701 -0.3346600
# 4                  0.10714967 -0.2774650 -0.2774633
# 5                 -0.01189399 -0.3081798 -0.3081739
# 6                 -0.01774873 -0.3062166 -0.3062066
```

---
# Fitting the RDA


```r
myRDA &lt;- vegan::rda(cwm.tab~.,data =  ClimateSS[,2:12])
myRDA
# Call: rda(formula = cwm.tab ~ MAT....C. + MI..unitless. +
# alpha..unitless. + GDD0...C.days. + mGDD0....C. + PAR0..mol.photon.m.2.
# + mPAR0..mol.photon.m.2. + Prec.Timing..month.from.Jan1st. +
# Prec.Seasonality..unitless. + MMP..mm. + MAP..mm., data = ClimateSS[,
# 2:12])
# 
#               Inertia Proportion Rank
# Total         36.2389     1.0000     
# Constrained    8.9189     0.2461    6
# Unconstrained 27.3200     0.7539    6
# Inertia is variance 
# 
# Eigenvalues for constrained axes:
#  RDA1  RDA2  RDA3  RDA4  RDA5  RDA6 
# 4.595 2.363 1.059 0.557 0.271 0.073 
# 
# Eigenvalues for unconstrained axes:
#   PC1   PC2   PC3   PC4   PC5   PC6 
# 8.270 7.302 4.424 3.714 2.574 1.036
```

---
# Fitting the RDA

- What if predictor variables are highly correlated? 

- How to test for multicolinearity? 



```r
# computing VIF using vegan::vif.cca
# values above 10, indicate high multicolinearity

vegan::vif.cca(myRDA) &gt;10
#                       MAT....C.                   MI..unitless. 
#                            TRUE                            TRUE 
#                alpha..unitless.                  GDD0...C.days. 
#                            TRUE                            TRUE 
#                     mGDD0....C.           PAR0..mol.photon.m.2. 
#                            TRUE                            TRUE 
#          mPAR0..mol.photon.m.2. Prec.Timing..month.from.Jan1st. 
#                            TRUE                           FALSE 
#     Prec.Seasonality..unitless.                        MMP..mm. 
#                           FALSE                            TRUE 
#                        MAP..mm. 
#                            TRUE
```


---
# Fitting the RDA: Multicolinearity


&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-46-1.png" width="360" style="display: block; margin: auto;" /&gt;

---
# Fitting the RDA: Model examination 

```r
anova(myRDA, by = "term")
# Permutation test for rda under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = cwm.tab ~ MAT....C. + MI..unitless. + alpha..unitless. + GDD0...C.days. + mGDD0....C. + PAR0..mol.photon.m.2. + mPAR0..mol.photon.m.2. + Prec.Timing..month.from.Jan1st. + Prec.Seasonality..unitless. + MMP..mm. + MAP..mm., data = ClimateSS[, 2:12])
#                                 Df Variance      F Pr(&gt;F)    
# MAT....C.                        1   1.5598 4.0536  0.001 ***
# MI..unitless.                    1   0.8443 2.1942  0.058 .  
# alpha..unitless.                 1   2.5982 6.7522  0.001 ***
# GDD0...C.days.                   1   1.8246 4.7418  0.002 ** 
# mGDD0....C.                      1   0.4508 1.1714  0.342    
# PAR0..mol.photon.m.2.            1   0.1800 0.4677  0.749    
# mPAR0..mol.photon.m.2.           1   0.2165 0.5628  0.716    
# Prec.Timing..month.from.Jan1st.  1   0.4488 1.1663  0.336    
# Prec.Seasonality..unitless.      1   0.3492 0.9076  0.385    
# MMP..mm.                         1   0.3636 0.9450  0.450    
# MAP..mm.                         1   0.0831 0.2160  0.973    
# Residual                        71  27.3200                  
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


---
# Fitting the RDA: Reducing model complexity 


```r
fwd.sel &lt;- ordiR2step(rda(cwm.tab ~ 1, data = ClimateSS[,2:12]),
                          scope = formula(myRDA), 
                      direction = "forward", 
                      R2scope = T, pstep = 1000, 
                      trace = T)
# Step: R2.adj= 0 
# Call: cwm.tab ~ 1 
#  
#                                    R2.adjusted
# &lt;All variables&gt;                    0.129314345
# + MMP..mm.                         0.053762360
# + MAP..mm.                         0.053762260
# + mGDD0....C.                      0.044434618
# + GDD0...C.days.                   0.040884237
# + MI..unitless.                    0.037796542
# + MAT....C.                        0.031227341
# + PAR0..mol.photon.m.2.            0.020978618
# + Prec.Timing..month.from.Jan1st.  0.017576279
# + Prec.Seasonality..unitless.      0.015463182
# + mPAR0..mol.photon.m.2.           0.010871023
# &lt;none&gt;                             0.000000000
# + alpha..unitless.                -0.002032387
# 
#            Df    AIC     F Pr(&gt;F)   
# + MMP..mm.  1 295.37 5.659  0.002 **
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Step: R2.adj= 0.05376236 
# Call: cwm.tab ~ MMP..mm. 
#  
#                                   R2.adjusted
# &lt;All variables&gt;                    0.12931435
# + mGDD0....C.                      0.08116449
# + alpha..unitless.                 0.07351649
# + mPAR0..mol.photon.m.2.           0.07281936
# + GDD0...C.days.                   0.07113327
# + MI..unitless.                    0.05856115
# + Prec.Seasonality..unitless.      0.05590536
# + MAT....C.                        0.05402686
# &lt;none&gt;                             0.05376236
# + PAR0..mol.photon.m.2.            0.04846141
# + MAP..mm.                         0.04748273
# + Prec.Timing..month.from.Jan1st.  0.04630581
# 
#               Df   AIC      F Pr(&gt;F)  
# + mGDD0....C.  1 293.9 3.4156  0.016 *
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Step: R2.adj= 0.08116449 
# Call: cwm.tab ~ MMP..mm. + mGDD0....C. 
#  
#                                   R2.adjusted
# &lt;All variables&gt;                    0.12931435
# + alpha..unitless.                 0.12628318
# + mPAR0..mol.photon.m.2.           0.09890860
# + MAT....C.                        0.09141479
# + GDD0...C.days.                   0.09057047
# + MI..unitless.                    0.08807574
# + PAR0..mol.photon.m.2.            0.08682229
# + Prec.Seasonality..unitless.      0.08401607
# &lt;none&gt;                             0.08116449
# + MAP..mm.                         0.07395668
# + Prec.Timing..month.from.Jan1st.  0.07321089
# 
#                    Df    AIC      F Pr(&gt;F)   
# + alpha..unitless.  1 290.68 5.1312  0.004 **
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Step: R2.adj= 0.1262832 
# Call: cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless. 
#  
#                                   R2.adjusted
# + PAR0..mol.photon.m.2.             0.1453515
# + MAT....C.                         0.1427552
# + GDD0...C.days.                    0.1424106
# + MI..unitless.                     0.1380613
# + Prec.Seasonality..unitless.       0.1306560
# &lt;All variables&gt;                     0.1293143
# &lt;none&gt;                              0.1262832
# + mPAR0..mol.photon.m.2.            0.1261316
# + MAP..mm.                          0.1189832
# + Prec.Timing..month.from.Jan1st.   0.1186208
```





---
# Fitting the RDA: Reducing model complexity 


```r
fwd.sel$call
# rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless., 
#     data = ClimateSS[, 2:12])

myRDA2 &lt;- vegan::rda(cwm.tab~  MMP..mm. +  mGDD0....C. + alpha..unitless.
                     ,data =  ClimateSS[,2:12])
summary(myRDA2)
# 
# Call:
# rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless.,      data = ClimateSS[, 2:12]) 
# 
# Partitioning of variance:
#               Inertia Proportion
# Total          36.239     1.0000
# Constrained     5.735     0.1582
# Unconstrained  30.504     0.8418
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#                         RDA1    RDA2    RDA3    PC1    PC2    PC3    PC4
# Eigenvalue            3.9007 1.74018 0.09384 9.2219 8.1766 4.6127 4.2420
# Proportion Explained  0.1076 0.04802 0.00259 0.2545 0.2256 0.1273 0.1171
# Cumulative Proportion 0.1076 0.15566 0.15825 0.4127 0.6384 0.7656 0.8827
#                           PC5     PC6
# Eigenvalue            3.10836 1.14267
# Proportion Explained  0.08577 0.03153
# Cumulative Proportion 0.96847 1.00000
# 
# Accumulated constrained eigenvalues
# Importance of components:
#                         RDA1   RDA2    RDA3
# Eigenvalue            3.9007 1.7402 0.09384
# Proportion Explained  0.6802 0.3034 0.01636
# Cumulative Proportion 0.6802 0.9836 1.00000
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  7.383244 
# 
# 
# Species scores
# 
#                     RDA1      RDA2     RDA3     PC1     PC2     PC3
# Average.LA..m2.  0.42824  0.007481  0.02272  1.9701  0.4549 -2.0022
# SLA..m2.kg.     -0.91060  0.843021  0.05601  0.3694  1.5888  0.5293
# LMA..kg.m2.      1.37875 -0.554421 -0.03914 -0.5906 -1.1155 -0.7374
# LDMC..mg.g.      0.59189 -0.433876 -0.02592  1.3881 -1.4768  1.2553
# Cmass..g.kg.    -0.05576  0.393600 -0.36355  2.6538 -0.6913  0.4300
# Nmass..g.kg.     1.61267  1.120882  0.05600  0.7320  2.3802  0.5875
# 
# 
# Site scores (weighted sums of species scores)
# 
#          RDA1      RDA2     RDA3        PC1        PC2       PC3
# 1   -0.351894  0.399944  -1.0979 -3.927e-02  0.0218482 -0.089914
# 2    0.048867  0.027168  -0.9758  1.199e-02 -0.0451722 -0.082245
# 3   -1.233398  2.568857   3.2599  7.367e-02  1.1682098  0.589547
# 4   -1.212629 -1.756887   5.8817 -6.425e-01 -0.6123875  0.080421
# 5   -1.445743  0.831600   2.7930 -2.205e-01  0.3142250  0.042692
# 6   -0.963808 -1.006819   6.7510 -4.421e-01 -0.3192448  0.165118
# 7    0.014977  0.167124   2.2147 -9.611e-02  0.1653662 -0.010085
# 8   -0.487031 -0.957606   2.9455 -1.880e-01 -0.4146558 -0.045969
# 9   -0.539549 -1.560975  -7.7878  5.008e-01 -1.0400032  0.305445
# 10  -0.762417  0.128985   0.8979  4.999e-03  0.3381020 -0.470826
# 11  -0.984558  0.138022   0.3387  7.028e-02  0.2419547  0.441999
# 12  -0.149660  0.176334   3.4676  8.767e-02  0.5158263 -0.482715
# 13  -0.425983 -0.008285  -6.2915  4.418e-01 -0.0877630  0.201789
# 14   0.058191 -0.264945  -2.6090  1.993e-01 -0.0047710  0.076755
# 15   0.219106 -0.039700  -0.0207  8.839e-02  0.0713228 -0.017203
# 16   0.036602  2.645638   2.2522  1.622e-01  1.3378339  0.390280
# 17   0.005651  0.060484   3.2107 -5.196e-02  0.2302858 -0.453679
# 18  -0.090334 -1.052896  -5.0268  2.219e-01 -0.7316133  0.109898
# 19  -0.061669  0.221609  -1.1274  9.410e-02  0.0376960  0.034046
# 20   0.070406 -0.261508  -0.3120  8.459e-05 -0.2155680 -0.094397
# 21   0.330316 -0.012483  -0.7269 -1.610e-01 -0.3274800 -0.082038
# 22   0.025594  0.055141  -0.9276 -4.637e-02 -0.2775433 -0.248477
# 23   0.117368 -1.074440  -3.9036  1.274e-01 -0.9706117  0.273975
# 24  -0.183031 -0.105367   0.1342 -1.015e-01 -0.2415927 -0.196639
# 25  -1.270866 -1.040158   2.0592 -6.145e-01 -0.5215255 -0.489895
# 26   0.833619 -0.700718  -3.0774  1.277e-01 -0.5737472 -0.231373
# 27   0.121241 -0.146043  -3.4622  9.079e-02 -0.2896794 -0.122241
# 28   0.040870  0.084541  -2.1463 -2.589e-02 -0.1353150 -0.040365
# 29  -1.018226  0.559981   0.6382 -4.440e-01  0.3220960 -0.080465
# 30   0.220313 -0.456893  -2.3968 -2.545e-03 -0.2381863  0.020511
# 31   0.337880 -0.143156  -2.2831  1.798e-01 -0.1476815  0.133024
# 32  -0.528535  1.557068   0.4501  3.712e-02  0.7302626  0.203057
# 33   0.142901  0.049883  -1.7347  1.619e-01  0.0002542  0.036558
# 34  -0.733286 -1.266382   3.7502 -3.916e-01 -0.2043371 -0.107076
# 35  -2.119929  0.556009   3.1992 -3.554e-01  0.3381114 -0.184805
# 36  -0.807765  2.560954  10.8578 -9.304e-01  1.7765224 -0.804874
# 37  -0.702433  1.234411   0.5386  8.196e-02  0.0561265  1.189889
# 38   2.732939  3.384620  18.0864 -1.595e+00  2.0654660  1.885730
# 39   2.787435 -0.570003 -10.5311  1.245e+00 -0.8701316  0.129442
# 40   1.420958  2.216051  -2.1775  6.170e-01  1.7386787 -2.510406
# 41  -0.024065 -0.735575   0.8702  6.529e-01  0.1885991  0.582680
# 42   1.818896 -3.629604  26.1649 -2.608e+00  0.1957043 -0.415742
# 43   0.670114 -2.846176 -13.2930  4.022e-01 -1.6143147  0.348319
# 44   2.984497 -3.488587  -4.6644 -1.045e-01 -1.6654231  0.109881
# 45   2.087258 -3.088162  10.4473 -1.321e+00 -0.5033726 -1.712496
# 46  -2.704725  0.441095   5.3081 -8.580e-01  0.3665978  0.204968
# 47  -1.521035  0.746774   5.8273 -3.202e-01  0.2649124 -0.444018
# 51  -0.200036  0.280599  -0.4094 -5.660e-02  0.1528145 -0.167920
# 63  -0.456892  0.610353   1.1125  2.855e-03  0.6234759 -0.067404
# 83   0.745432 -2.616548 -30.3241  1.696e+00 -1.7290349  1.093371
# 84   2.173702 -3.793969  -3.8007  1.337e+00 -0.8332568 -4.455641
# 85   2.178725  1.283421   1.2143 -1.814e-01  0.9540729  1.698935
# 86   0.255910 -0.470190  10.1477 -8.083e-01  0.5040887  1.025790
# 87   1.250553 -0.939508  -5.1293  8.000e-01 -0.4586516  2.159502
# 88   3.233879  6.278951   7.8794 -1.047e+00  2.4171876  0.244872
# 89   1.535814 -0.340193 -11.2084  1.019e+00 -1.5101918  0.857938
# 90   0.087891 -3.260740   2.7359 -2.232e+00 -1.3446746 -1.527541
# 91  -1.110798 -5.760571  -1.3168 -3.679e-01 -1.4927247  0.217995
# 92  -2.583282 -0.457841   6.9548 -1.078e-01  1.4977734 -0.244736
# 177 -0.075141  0.304040  -1.0640  1.597e-01  0.0095198  0.133115
# 178 -0.605226  1.036940   0.7587  1.472e-01  0.2198655  0.367795
# 179 -0.066303  0.299437  -0.3243  1.129e-01  0.1732452  0.053316
# 180 -0.802986  0.758988   1.4653 -1.670e-01 -0.3113467  0.399535
# 182 -0.846842  1.249479  -0.1374  2.138e-01  0.3181378  0.429204
# 183 -0.293904  1.383991   3.9277 -9.884e-02  0.6887347  0.122407
# 184 -0.178401  0.814552  -0.6407  1.579e-01  0.0712202  0.113667
# 224  2.508928 -1.840494  -5.0335  5.447e-01 -0.4337727 -0.037450
# 225 -0.605338 -0.122712  -0.1130 -4.170e-02 -0.0107211  0.316160
# 226 -0.072203 -0.997970  10.3706 -6.790e-01  0.2680164 -1.173972
# 227 -0.656478  0.813803   0.5620 -2.984e-01  0.1597363 -0.160058
# 229 -0.298141  0.234013  -1.2513  6.320e-02 -0.1708521  0.328787
# 230 -0.063183  0.200069  -0.7947 -4.078e-02 -0.0217192 -0.052579
# 231 -0.345826  0.568688  -0.9945  3.510e-03 -0.0838339 -0.001915
# 232 -0.247615 -0.268603  -2.9661  1.311e-01 -0.0421712 -0.038149
# 233  0.232444 -0.054238  -1.2508  2.069e-01 -0.1904851  0.054662
# 234 -0.033976 -0.326874   2.1619 -3.994e-02 -0.2708235 -0.504479
# 235 -0.541583  1.571530  -6.5814  5.847e-01  0.0376459  0.215758
# 236 -0.319090  0.029328   0.4873 -5.260e-02 -0.3857331 -0.110665
# 237  0.226776  0.586315   2.0339 -4.141e-02 -0.1290101 -0.229333
# 242 -0.720051 -1.077550   3.6515 -6.100e-01 -0.5361638  0.386998
# 243 -1.047114  0.271473 -11.3778  7.041e-01 -0.6655223  0.629286
# 244 -1.506595  0.572021  -6.4860  2.550e-01 -0.4353287  0.429751
# 245  2.443524  8.581087 -10.0302  4.611e+00  2.5266012 -0.645078
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
#          RDA1       RDA2     RDA3        PC1        PC2       PC3
# 1   -0.296022  0.3399014 -0.33901 -3.927e-02  0.0218482 -0.089914
# 2   -0.387236  0.1334107 -0.41402  1.199e-02 -0.0451722 -0.082245
# 3   -0.890784 -0.0914310  0.60648  7.367e-02  1.1682098  0.589547
# 4   -0.846132  0.1717805  0.80771 -6.425e-01 -0.6123875  0.080421
# 5   -0.781048  0.2835180  0.75448 -2.205e-01  0.3142250  0.042692
# 6   -0.801472  0.2042756  0.73051 -4.421e-01 -0.3192448  0.165118
# 7   -0.841294  0.0184084  0.61483 -9.611e-02  0.1653662 -0.010085
# 8   -0.917672  0.2049345  1.07859 -1.880e-01 -0.4146558 -0.045969
# 9   -0.976220 -0.1446562  1.14213  5.008e-01 -1.0400032  0.305445
# 10  -0.991376 -0.4305070  0.70768  4.999e-03  0.3381020 -0.470826
# 11  -0.793461 -0.5295752 -0.21902  7.028e-02  0.2419547  0.441999
# 12  -0.774528 -0.4942354 -0.21703  8.767e-02  0.5158263 -0.482715
# 13  -0.598489 -0.4409709 -0.56160  4.418e-01 -0.0877630  0.201789
# 14  -0.644121 -0.4741748 -0.53454  1.993e-01 -0.0047710  0.076755
# 15  -0.530091 -0.1573224 -0.41871  8.839e-02  0.0713228 -0.017203
# 16  -0.540099 -0.2626326 -0.50926  1.622e-01  1.3378339  0.390280
# 17  -0.440253  0.0369168 -0.39849 -5.196e-02  0.2302858 -0.453679
# 18  -0.412720  0.1249643 -0.37557  2.219e-01 -0.7316133  0.109898
# 19  -0.365349  0.0648703 -0.52753  9.410e-02  0.0376960  0.034046
# 20  -0.337151  0.2721574 -0.39574  8.459e-05 -0.2155680 -0.094397
# 21  -0.299890  0.7693873 -0.03957 -1.610e-01 -0.3274800 -0.082038
# 22  -0.251442  0.7298149 -0.21852 -4.637e-02 -0.2775433 -0.248477
# 23  -0.218578  0.6902653 -0.34649  1.274e-01 -0.9706117  0.273975
# 24  -0.233745  0.5791592 -0.43981 -1.015e-01 -0.2415927 -0.196639
# 25  -0.157266  0.6143988 -0.57932 -6.145e-01 -0.5215255 -0.489895
# 26  -0.076893  0.4915932 -0.92273  1.277e-01 -0.5737472 -0.231373
# 27  -0.062294  0.3408552 -1.15037  9.079e-02 -0.2896794 -0.122241
# 28   0.012799  0.3443450 -1.32505 -2.589e-02 -0.1353150 -0.040365
# 29  -0.035223  0.1217331 -1.48534 -4.440e-01  0.3220960 -0.080465
# 30  -0.044697  0.0232796 -1.60051 -2.545e-03 -0.2381863  0.020511
# 31  -0.019430  0.0518826 -1.62609  1.798e-01 -0.1476815  0.133024
# 32  -0.033882  0.0006276 -1.65966  3.712e-02  0.7302626  0.203057
# 33  -0.036429 -0.0045465 -1.65948  1.619e-01  0.0002542  0.036558
# 34  -0.400174 -0.4106139  0.13891 -3.916e-01 -0.2043371 -0.107076
# 35  -0.047439  0.1044810  0.54406 -3.554e-01  0.3381114 -0.184805
# 36   0.168545 -0.1160460  0.88381 -9.304e-01  1.7765224 -0.804874
# 37   1.811007  0.6075198  0.50948  8.196e-02  0.0561265  1.189889
# 38   1.292732  0.0991881  0.59949 -1.595e+00  2.0654660  1.885730
# 39   2.194476  0.2103879  0.36886  1.245e+00 -0.8701316  0.129442
# 40   1.060975 -1.1668058  0.54266  6.170e-01  1.7386787 -2.510406
# 41   0.903550 -1.6185993  0.54014  6.529e-01  0.1885991  0.582680
# 42   1.653561 -1.1281779  0.38528 -2.608e+00  0.1957043 -0.415742
# 43   1.703064 -0.5722964  0.42761  4.022e-01 -1.6143147  0.348319
# 44   0.653224 -0.0950626  0.76121 -1.045e-01 -1.6654231  0.109881
# 45   0.570285 -0.3336132  0.75983 -1.321e+00 -0.5033726 -1.712496
# 46  -0.371027  0.0401392  0.81981 -8.580e-01  0.3665978  0.204968
# 47  -0.130380  0.8116549  0.26370 -3.202e-01  0.2649124 -0.444018
# 51  -0.011104  0.1003443 -1.59832 -5.660e-02  0.1528145 -0.167920
# 63  -0.360505 -0.5587170 -1.44715  2.855e-03  0.6234759 -0.067404
# 83   0.533873 -1.9773557  0.10137  1.696e+00 -1.7290349  1.093371
# 84   1.411753 -1.0140627  0.01671  1.337e+00 -0.8332568 -4.455641
# 85   1.270221 -1.3164797  0.12194 -1.814e-01  0.9540729  1.698935
# 86   1.643572 -0.9092676  0.08638 -8.083e-01  0.5040887  1.025790
# 87   1.270221 -1.3164797  0.12194  8.000e-01 -0.4586516  2.159502
# 88   1.700464  1.5763016  0.16582 -1.047e+00  2.4171876  0.244872
# 89   1.671819  1.5262194  0.16140  1.019e+00 -1.5101918  0.857938
# 90   1.351468  1.0473560  0.15017 -2.232e+00 -1.3446746 -1.527541
# 91  -0.872954 -2.5630807  0.19531 -3.679e-01 -1.4927247  0.217995
# 92  -1.333127 -3.1479487  0.18272 -1.078e-01  1.4977734 -0.244736
# 177 -0.400707  0.1178729 -0.01282  1.597e-01  0.0095198  0.133115
# 178 -0.234496  0.3658420  0.05313  1.472e-01  0.2198655  0.367795
# 179 -0.333850 -0.1213017 -0.52243  1.129e-01  0.1732452  0.053316
# 180  0.627033  1.3027139  0.89787 -1.670e-01 -0.3113467  0.399535
# 182 -0.350327  0.1964215  0.30494  2.138e-01  0.3181378  0.429204
# 183 -0.381680  0.1146653  0.33043 -9.884e-02  0.6887347  0.122407
# 184 -0.364328  0.4674282  0.70269  1.579e-01  0.0712202  0.113667
# 224  1.075514 -1.3791957  0.05178  5.447e-01 -0.4337727 -0.037450
# 225 -0.018688 -0.3279268  0.91349 -4.170e-02 -0.0107211  0.316160
# 226 -0.008138 -0.3265852  0.91075 -6.790e-01  0.2680164 -1.173972
# 227  0.523595  0.7656139 -2.10849 -2.984e-01  0.1597363 -0.160058
# 229  0.249920  0.4910796 -1.56181  6.320e-02 -0.1708521  0.328787
# 230 -0.107866  0.2689848 -0.66340 -4.078e-02 -0.0217192 -0.052579
# 231 -0.057144  0.7247522 -0.62066  3.510e-03 -0.0838339 -0.001915
# 232 -0.556264 -0.3819488 -0.52762  1.311e-01 -0.0421712 -0.038149
# 233 -0.484389  0.2612145 -0.44306  2.069e-01 -0.1904851  0.054662
# 234 -0.510558  0.5696384  1.11947 -3.994e-02 -0.2708235 -0.504479
# 235 -0.426436  0.6502894  1.10468  5.847e-01  0.0376459  0.215758
# 236 -0.206564  0.8905323  1.06896 -5.260e-02 -0.3857331 -0.110665
# 237 -0.065541  1.0646830  1.04807 -4.141e-02 -0.1290101 -0.229333
# 242 -1.084721  0.3919304  0.78688 -6.100e-01 -0.5361638  0.386998
# 243 -1.084721  0.3919304  0.78688  7.041e-01 -0.6655223  0.629286
# 244 -1.142286  0.7372385  1.20035  2.550e-01 -0.4353287  0.429751
# 245  0.627033  1.3027139  0.89787  4.611e+00  2.5266012 -0.645078
# 
# 
# Biplot scores for constraining variables
# 
#                    RDA1     RDA2     RDA3 PC1 PC2 PC3
# MMP..mm.         0.7311 -0.38002  0.56662   0   0   0
# mGDD0....C.      0.3694 -0.92851 -0.03798   0   0   0
# alpha..unitless. 0.2614 -0.09641  0.96041   0   0   0
```


---
# Fitting the RDA: Model examination 


```r
vegan::RsquareAdj(myRDA2)
# $r.squared
# [1] 0.1582484
# 
# $adj.r.squared
# [1] 0.1262832
vegan::vif.cca(myRDA2)
#         MMP..mm.      mGDD0....C. alpha..unitless. 
#         6.148742         2.541900         4.014843
```


---
# Fitting the RDA: Model examination 


```r
anova(myRDA2)
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless., data = ClimateSS[, 2:12])
#          Df Variance      F Pr(&gt;F)    
# Model     3   5.7347 4.9506  0.001 ***
# Residual 79  30.5042                  
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```




---
# Fitting the RDA: Model examination 


```r
anova(myRDA2, by = "term")
# Permutation test for rda under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless., data = ClimateSS[, 2:12])
#                  Df Variance      F Pr(&gt;F)    
# MMP..mm.          1   2.3665 6.1287  0.001 ***
# mGDD0....C.       1   1.3870 3.5920  0.007 ** 
# alpha..unitless.  1   1.9813 5.1312  0.001 ***
# Residual         79  30.5042                  
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```



---
# Fitting the RDA: Model examination 


```r
anova(myRDA2, step = 1000, by = "axis")
# Permutation test for rda under reduced model
# Forward tests for axes
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless., data = ClimateSS[, 2:12])
#          Df Variance       F Pr(&gt;F)    
# RDA1      1   3.9007 10.1021  0.001 ***
# RDA2      1   1.7402  4.5068  0.008 ** 
# RDA3      1   0.0938  0.2430  0.940    
# Residual 79  30.5042                   
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```




---
# Fitting the RDA: Model examination 

- 2 scalings

0: Similarities between objects 

1: Correlation among variables

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-54-1.png" width="360" style="display: block; margin: auto;" /&gt;


---
# Fitting the RDA: Model examination 

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-55-1.png" width="360" style="display: block; margin: auto;" /&gt;









    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="R-macros.js"></script>
<script>var slideshow = remark.create({
"highlightLines": true,
"highlightStyle": "github"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
