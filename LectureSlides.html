<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Relating species characteristics to their environmnent - RDA</title>
    <meta charset="utf-8" />
    <meta name="date" content="2022-05-04" />
    <script src="assets/header-attrs-2.9/header-attrs.js"></script>
    <link href="assets/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="R.css" type="text/css" />
    <link rel="stylesheet" href="fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Relating species characteristics to their environmnent - RDA
### 
### 05/04/2022

---





# About me: Gabriel Muñoz  

**Quantitative Ecologist**


**Ph.D. candidate** in Biological Sciences @Concordia University

.tiny[**M.Sc. Biology**, *track* Ecology and Evolution @University of Amsterdam, NL]

.tiny[**B.Sc. Biology**  @Universidad San Francisco de Quito, EC]



&lt;img src="images/Lab Logo.png" width="30%" style="display: block; margin: auto;" /&gt;





---
# Learning objectives:

&lt;br&gt;


- **The diversity of species characteristics  in ecological communities (Functional diversity) **

- **Quantify changes in functional diversity along environmental gradients** 


&lt;br&gt;

## Lecture structure 

1) Functional Ecology (~20min)

2) Redundancy Analysis (RDA) (~15min)

3) Case study (~30 min)

&lt;br&gt;

.alert[You can stop me anytime for questions]




---
## Important note

.alert[Your feedback is important to me]


https://www.cognitoforms.com/BiologyCU/BIOL801StudentLectureFeedback


mail: gabriel.munoz@concordia.ca


---
class: inverse, center, middle
# 1. Functional Ecology


---
# Biodiversity: The diversity of lifeforms 


&lt;img src="images/Biodiversity-1-1024x576.png" width="80%" style="display: block; margin: auto;" /&gt;


---
# The diversity of lifeforms and climates 

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/Cuyabeno.jpeg" alt=" Flooded forests in Cuyabeno, Sucumbios Ecuador" width="80%" /&gt;
&lt;p class="caption"&gt; Flooded forests in Cuyabeno, Sucumbios Ecuador&lt;/p&gt;
&lt;/div&gt;
---
# The diversity of lifeforms and climates 


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/CEiboManabi.jpeg" alt="Ceibo-Manabí, Ecuador" width="80%" /&gt;
&lt;p class="caption"&gt;Ceibo-Manabí, Ecuador&lt;/p&gt;
&lt;/div&gt;
---
# The diversity of lifeforms and climates  
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/lengaPatagonia.JPG" alt="Lenga forest, El Chalten, Patagonia, Argentina" width="80%" /&gt;
&lt;p class="caption"&gt;Lenga forest, El Chalten, Patagonia, Argentina&lt;/p&gt;
&lt;/div&gt;


---
# The diversity of lifeforms and climates  
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/Atacama.JPG" alt="Atacama desert, Chile" width="80%" /&gt;
&lt;p class="caption"&gt;Atacama desert, Chile&lt;/p&gt;
&lt;/div&gt;


---
# The dimensions of biodiversity

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;" /&gt;




---
# Funtional diversity: Species traits 

.alert[Traits: species unique characteristics]

- **Traits that allows species to live where they live**

- Traits that allow species to interact with others

- Traits that influence the impact of a species in the ecosystem

&lt;img src="images/Mammals.png" width="40%" style="display: block; margin: auto;" /&gt;




---
# The ecological niche 

.alert[Niche: The relative positioning of species in a ecological space]

- Grinnellian niche view: Species environmental tolerances (physiological requirements)


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/drosophilagrowth.jpeg" alt="Drosophila growth, Bozinovic et al., 2011" width="60%" /&gt;
&lt;p class="caption"&gt;Drosophila growth, Bozinovic et al., 2011&lt;/p&gt;
&lt;/div&gt;


---
# The ecological niche 

.alert[Niche: The relative positioning of species in a ecological space]


- Eltonian niche view : Biotic dimensions (species interactions)


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/radiation.jpeg" alt="Finch radiation" width="80%" /&gt;
&lt;p class="caption"&gt;Finch radiation&lt;/p&gt;
&lt;/div&gt;

---
# The ecological niche 

.alert[Niche: The relative positioning of species in a ecological space]

- Hutchinson: n-dimensional hypervolume (both Env + Int)

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/hutch.png" alt="High dimensional volume" width="60%" /&gt;
&lt;p class="caption"&gt;High dimensional volume&lt;/p&gt;
&lt;/div&gt;


.alert[!Neutral theory of biodiversity: All species are equivalent]


---
#  Distribution of ecological niches drive the composition of biotas


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/WhittkerPlot.png" alt="Whittaker plot" width="50%" /&gt;
&lt;p class="caption"&gt;Whittaker plot&lt;/p&gt;
&lt;/div&gt;


---
# Niche-based assembly processes 


.alert[.small[Ecological communities: 
Sets of interacting species within a
considerable area of space and period of time  ]]

.alert[Deterministic processes]

- Species sorting / Limiting similarity principle 

- Fundamental and realized niches


&lt;img src="images/sortingCExclusion.png" width="50%" style="display: block; margin: auto;" /&gt;




---
# Funtional diversity: a driver of innovation in Ecology 


Species functional traits --&gt; ** Phenotypes reflecting species adaptations to their ecological niches**

- Allow testing more mechanistic hypothesis in community assembly 

- Relate species functions to climatic variation 

- Identify transition zones 

- Predict consequences of global climate changes in biodiversity

---
# Functional diversity: The knowledge gap

- Global trait databases

- Species responses to global change


https://www.try-db.org/TryWeb/Home.php



&lt;img src="images/plantTraits.png" style="display: block; margin: auto;" /&gt;


---
# Quantifying functional diversity: Functional position (identity)


`$$CWM = \dfrac{\sum_{i = 1}^{n} (x_i \times w_i)}{ \sum_{i = 1}^{n} (w_i)}$$`


&lt;img src="images/CWM.png" width="90%" style="display: block; margin: auto;" /&gt;

---
# Quantifying functional diversity: Functional range


`$$T_{max} - T_{min}$$` 


&lt;img src="images/range.png" width="90%" style="display: block; margin: auto;" /&gt;


---
# Quantifying functional diversity: Functional dispersion 

$$ SD(\{d_i,\cdots, d_i\}) $$ 

&lt;img src="images/TraitDis.png" width="90%" style="display: block; margin: auto;" /&gt;


---
# Functional diversity changes along gradients 

- Inferring process from patterns

&lt;img src="images/TestHyp.png" width="80%" style="display: block; margin: auto;" /&gt;




---
class: inverse, center, middle

## Redundancy analysis (RDA)


---
# Ordinations

- Useful to represent the variance-covariance of multidimensional datasets

- Techniques to reduce dataset dimensionality into fewer synthetic variables 

- Descriptive of data-structure (Unconstrained)

- e.g. Principal Component Analysis 


.pull-left[
&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-19-1.png" width="360" style="display: block; margin: auto;" /&gt;

]


.pull-right[
&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-20-1.png" width="80%" style="display: block; margin: auto;" /&gt;

]


---
# Canonical Analysis


- Method first described by Rao (1964)
 
 
&lt;img src="images/Rao.jpeg" width="70%" style="display: block; margin: auto;" /&gt;


---
# Canonical Analysis


- Finds relationships between response and predictor matrices 

- *Y* = Sites x Species | *X* = Sites x Environmental variables 

- RDA | CCA 

&lt;img src="images/SITES_ENVAR.png" width="60%" style="display: block; margin: auto;" /&gt;


---
#  Redundancy analysis (RDA)


- RDA - Redundancy analysis:

- Combines multivariate linear regression and ordinations 

- How much variance of in Y can be explained by the variance in X

&lt;img src="images/MultivariateRe.png" width="60%" style="display: block; margin: auto;" /&gt;

---
# Redundancy analysis: Important considerations

- Independence of observations 

- Linear relationships between Y~X 

- No multicolinearity 

  - Plots and variance inflation factors, evaluate the need for transformation 
  - Rare species are removed 

- (# sites &gt;&gt; # predictors) 

---
# Redundancy analysis: Underlying mechanics 

- 2 step process 

- First multivariate regression, then PCA on fitted values 

- Fits Y table to the linear combination of environmental variables 

&lt;img src="images/constrained_ord_diagram.png" width="30%" style="display: block; margin: auto;" /&gt;

---
# Redundancy analysis: Interpreting results

&lt;img src="images/triplot.png" width="60%" style="display: block; margin: auto;" /&gt;


---
# Redundancy analysis: Important technical questions

- How many axes are required? 

- Hypothesis test, by permutations?

- How many variables are needed?

- How important are my different variables? 

- Which scaling report? 

---
class: inverse, center, middle

## Case study: Relating species characteristics to their environment-Redundancy analysis (RDA)

---
# Case study: The geography of China


&lt;img src="images/ChinaGeogrp.jpeg" width="80%" style="display: block; margin: auto;" /&gt;

---
# Case study: The China Plant Trait Database


&lt;img src="images/ChinaPlantTrait.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Case study: The China Plant Trait Database





```
#  [1] "ID"              "SAMPLE.ID"       "Average.LA..m2." "SLA..m2.kg."    
#  [5] "LMA..kg.m2."     "LDMC..mg.g."     "Cmass..g.kg."    "Nmass..g.kg."   
#  [9] "Pmass..g.kg."    "Kmass..g.kg."    "Narea..g.m2."    "Parea..g.m2."   
# [13] "Karea..g.m2."    "d13C.12C"        "d15N.14N"
#  [1] "Site.ID"           "Site.Name"         "Latitude"         
#  [4] "Longitude"         "Elevation"         "Collection.month" 
#  [7] "Collection.year"   "Source"            "Sampling.strategy"
# [10] "References"
```


&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-30-1.png" width="360" style="display: block; margin: auto;" /&gt;


---
## Case study: The China Plant Trait Database

How many species are in the dataset? 

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-31-1.png" width="360" style="display: block; margin: auto;" /&gt;


---
## Case study: The China Plant Trait Database


```
#   ID Site.ID Original.Genus Original.Species ACCEPTED.GENUS ACCEPTED.SPECIES
# 1  1       1         Allium        senescens         Allium        senescens
# 2  2       1      Artemisia          frigida      Artemisia          frigida
# 3  3       1      Artemisia         sacrorum      Artemisia         gmelinii
# 5  5       1     Astragalus       galactites     Astragalus       galactites
# 6  6       1     Astragalus      scaberrimus     Astragalus      scaberrimus
#   SPECIES.ID SAMPLE.ID Average.LA..m2. SLA..m2.kg. LMA..kg.m2. LDMC..mg.g.
# 1       SP81         1      2.0010e-04    13.71253  0.07348235    353.7245
# 2      SP142         2      1.0005e-05    24.32378  0.04121057    457.2960
# 3      SP144         3      5.3360e-06    21.94605  0.04580574    336.3854
# 5      SP176         5      1.0672e-04          NA          NA          NA
# 6      SP182         6      6.6700e-05    12.14942  0.08294345    344.2806
#   Cmass..g.kg. Nmass..g.kg. Pmass..g.kg. Kmass..g.kg. Narea..g.m2. Parea..g.m2.
# 1           NA           NA           NA           NA           NA           NA
# 2      544.229     20.31644     1.407591    16.522977    0.8352501   0.05786894
# 3      459.178     21.10508     1.602951    18.167811    0.9616803   0.07304054
# 5           NA           NA           NA           NA           NA           NA
# 6      332.739     25.87347     1.266567     9.725709    2.1296051   0.10424916
#   Karea..g.m2. d13C.12C d15N.14N
# 1           NA       NA       NA
# 2    0.6792932  -27.604   -2.863
# 3    0.8278397  -26.892   -3.057
# 5           NA       NA       NA
# 6    0.8005080  -25.749   -2.167
```


---
## Building the Y matrix: Handling missing data

Do we have missing data? 


```
# [1] "##### How many NA per trait? ###### "
#       Average.LA..m2. SLA..m2.kg. LMA..kg.m2. LDMC..mg.g. Cmass..g.kg.
# FALSE            1018        1034        1034         900          771
# TRUE              195         179         179         313          442
#       Nmass..g.kg. Pmass..g.kg. Kmass..g.kg. Narea..g.m2. Parea..g.m2.
# FALSE          922          666          619          918          664
# TRUE           291          547          594          295          549
#       Karea..g.m2. d13C.12C d15N.14N
# FALSE          617      469      381
# TRUE           596      744      832
```


---
## Building the Y matrix: Variable standardization


Range normalization

`\(\frac{x-x_{min}}{x_{max} - x_{min}}\)`


Mean + variance scaling 

`\(\frac{x-mean}{sd}\)`



&lt;img src="images/normalizeStandardize.png" width="60%" style="display: block; margin: auto;" /&gt;



---
## Building the Y matrix: Variable standardization

Range normalization


&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-35-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
## Building the Y matrix: Variable standardization

Mean-variance scaling


&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-36-1.png" width="60%" style="display: block; margin: auto;" /&gt;




---
## Building the Y matrix: Site-trait matrix 


&lt;img src="images/SiteTraitMat.png" width="90%" style="display: block; margin: auto;" /&gt;


.alert[What to do with differences in species richness among sites?]


---
## Building the Y matrix: Site-trait matrix 


How many species above a richness threshold? 

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-39-1.png" width="360" style="display: block; margin: auto;" /&gt;



---
## Building the Y matrix: Site-trait matrix 


&lt;img src="images/SiteTraitMat2.png" width="90%" style="display: block; margin: auto;" /&gt;


```
# [1] "### Dimensions of Sites x traits ####"
# [1] 83  6
```

---
## Building the X matrix: Environmental variable matrix 



```
#   Site.ID  MAT....C. MI..unitless. alpha..unitless. GDD0...C.days. mGDD0....C.
# 1       1 -0.5246671  -0.696001445       -0.5344169     -0.6404428  -0.5053884
# 2       2 -0.5131194  -0.744489595       -0.6275897     -0.5746852  -0.3080644
# 3       3 -0.3334891  -0.094307592        0.4396623     -0.4680040  -0.3276616
# 4       4 -0.4455442   0.040136822        0.6598889     -0.6107659  -0.6165521
# 5       5 -0.5138322  -0.001739307        0.6048323     -0.6824859  -0.7118353
# 6       6 -0.4374181  -0.017167354        0.5794215     -0.6229639  -0.6297296
#   PAR0..mol.photon.m.2. mPAR0..mol.photon.m.2. Prec.Timing..month.from.Jan1st.
# 1            -0.3280314              0.8678624                       0.1804618
# 2            -0.3795455              0.8322221                       0.1501914
# 3            -0.9143590             -0.4281475                       0.1143916
# 4            -0.9878796             -0.4047730                       0.1316360
# 5            -0.9956074             -0.2561948                       0.1248712
# 6            -0.9537671             -0.3263182                       0.1125261
#   Prec.Seasonality..unitless.   MMP..mm.   MAP..mm.
# 1                  0.93189191 -0.6594620 -0.6594516
# 2                  1.08839665 -0.6971349 -0.6971410
# 3                  0.14655210 -0.3346701 -0.3346600
# 4                  0.10714967 -0.2774650 -0.2774633
# 5                 -0.01189399 -0.3081798 -0.3081739
# 6                 -0.01774873 -0.3062166 -0.3062066
```

---
## Fitting the RDA


```
# Call: rda(formula = cwm.tab ~ MAT....C. + MI..unitless. +
# alpha..unitless. + GDD0...C.days. + mGDD0....C. + PAR0..mol.photon.m.2.
# + mPAR0..mol.photon.m.2. + Prec.Timing..month.from.Jan1st. +
# Prec.Seasonality..unitless. + MMP..mm. + MAP..mm., data = ClimateSS[,
# 2:12])
# 
#               Inertia Proportion Rank
# Total         35.9552     1.0000     
# Constrained    8.8486     0.2461    6
# Unconstrained 27.1066     0.7539    6
# Inertia is variance 
# 
# Eigenvalues for constrained axes:
#  RDA1  RDA2  RDA3  RDA4  RDA5  RDA6 
# 4.548 2.353 1.038 0.581 0.269 0.059 
# 
# Eigenvalues for unconstrained axes:
#   PC1   PC2   PC3   PC4   PC5   PC6 
# 8.331 7.309 4.272 3.756 2.437 1.002
```

---
## Fitting the RDA

- What if predictor variables are highly correlated? 

- How to test for multicolinearity? 



```
# [1] "computing VIF using vegan::vif.cca | values above 10, indicate high multicolinearity"
#                       MAT....C.                   MI..unitless. 
#                            TRUE                            TRUE 
#                alpha..unitless.                  GDD0...C.days. 
#                            TRUE                            TRUE 
#                     mGDD0....C.           PAR0..mol.photon.m.2. 
#                            TRUE                            TRUE 
#          mPAR0..mol.photon.m.2. Prec.Timing..month.from.Jan1st. 
#                            TRUE                           FALSE 
#     Prec.Seasonality..unitless.                        MMP..mm. 
#                           FALSE                            TRUE 
#                        MAP..mm. 
#                            TRUE
```


---
## Fitting the RDA: Multicolinearity


&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-45-1.png" width="360" style="display: block; margin: auto;" /&gt;

---
## Fitting the RDA: Model examination 

```
# Permutation test for rda under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = cwm.tab ~ MAT....C. + MI..unitless. + alpha..unitless. + GDD0...C.days. + mGDD0....C. + PAR0..mol.photon.m.2. + mPAR0..mol.photon.m.2. + Prec.Timing..month.from.Jan1st. + Prec.Seasonality..unitless. + MMP..mm. + MAP..mm., data = ClimateSS[, 2:12])
#                                 Df Variance      F Pr(&gt;F)    
# MAT....C.                        1   1.5927 4.1718  0.002 ** 
# MI..unitless.                    1   0.8065 2.1126  0.055 .  
# alpha..unitless.                 1   2.5582 6.7006  0.001 ***
# GDD0...C.days.                   1   1.7905 4.6898  0.003 ** 
# mGDD0....C.                      1   0.4284 1.1220  0.333    
# PAR0..mol.photon.m.2.            1   0.1928 0.5051  0.716    
# mPAR0..mol.photon.m.2.           1   0.2153 0.5638  0.702    
# Prec.Timing..month.from.Jan1st.  1   0.4403 1.1533  0.347    
# Prec.Seasonality..unitless.      1   0.3608 0.9451  0.360    
# MMP..mm.                         1   0.3660 0.9586  0.435    
# MAP..mm.                         1   0.0971 0.2543  0.950    
# Residual                        71  27.1066                  
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


---
## Fitting the RDA: Reducing model complexity 


```
# Step: R2.adj= 0 
# Call: cwm.tab ~ 1 
#  
#                                    R2.adjusted
# &lt;All variables&gt;                    0.129298683
# + MMP..mm.                         0.053889717
# + MAP..mm.                         0.053889601
# + mGDD0....C.                      0.044708054
# + GDD0...C.days.                   0.041720641
# + MI..unitless.                    0.037541742
# + MAT....C.                        0.032498196
# + PAR0..mol.photon.m.2.            0.021426807
# + Prec.Timing..month.from.Jan1st.  0.019181646
# + Prec.Seasonality..unitless.      0.016333179
# + mPAR0..mol.photon.m.2.           0.011425735
# &lt;none&gt;                             0.000000000
# + alpha..unitless.                -0.002271421
# 
#            Df    AIC      F Pr(&gt;F)   
# + MMP..mm.  1 294.71 5.6707  0.002 **
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Step: R2.adj= 0.05388972 
# Call: cwm.tab ~ MMP..mm. 
#  
#                                   R2.adjusted
# &lt;All variables&gt;                    0.12929868
# + mGDD0....C.                      0.08107884
# + alpha..unitless.                 0.07429096
# + GDD0...C.days.                   0.07138627
# + mPAR0..mol.photon.m.2.           0.07135295
# + MI..unitless.                    0.05863669
# + Prec.Seasonality..unitless.      0.05591863
# + MAT....C.                        0.05405431
# &lt;none&gt;                             0.05388972
# + PAR0..mol.photon.m.2.            0.04830147
# + MAP..mm.                         0.04829088
# + Prec.Timing..month.from.Jan1st.  0.04696096
# 
#               Df    AIC      F Pr(&gt;F)  
# + mGDD0....C.  1 293.25 3.3966  0.022 *
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Step: R2.adj= 0.08107884 
# Call: cwm.tab ~ MMP..mm. + mGDD0....C. 
#  
#                                   R2.adjusted
# &lt;All variables&gt;                    0.12929868
# + alpha..unitless.                 0.12660619
# + mPAR0..mol.photon.m.2.           0.09774370
# + MAT....C.                        0.08987301
# + GDD0...C.days.                   0.08904355
# + MI..unitless.                    0.08830164
# + PAR0..mol.photon.m.2.            0.08659817
# + Prec.Seasonality..unitless.      0.08380346
# &lt;none&gt;                             0.08107884
# + MAP..mm.                         0.07441159
# + Prec.Timing..month.from.Jan1st.  0.07360045
# 
#                    Df    AIC      F Pr(&gt;F)   
# + alpha..unitless.  1 289.99 5.1702  0.002 **
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Step: R2.adj= 0.1266062 
# Call: cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless. 
#  
#                                   R2.adjusted
# + PAR0..mol.photon.m.2.             0.1447464
# + MAT....C.                         0.1412856
# + GDD0...C.days.                    0.1411683
# + MI..unitless.                     0.1374076
# + Prec.Seasonality..unitless.       0.1308110
# &lt;All variables&gt;                     0.1292987
# &lt;none&gt;                              0.1266062
# + mPAR0..mol.photon.m.2.            0.1249962
# + MAP..mm.                          0.1197387
# + Prec.Timing..month.from.Jan1st.   0.1193242
```





---
## Fitting the RDA: Reducing model complexity 


```
# rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless., 
#     data = ClimateSS[, 2:12])
# 
# Call:
# rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless.,      data = ClimateSS[, 2:12]) 
# 
# Partitioning of variance:
#               Inertia Proportion
# Total          35.955     1.0000
# Constrained     5.701     0.1586
# Unconstrained  30.254     0.8414
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#                         RDA1    RDA2    RDA3    PC1    PC2    PC3    PC4
# Eigenvalue            3.8911 1.71892 0.09098 9.2906 8.1584 4.4920 4.2415
# Proportion Explained  0.1082 0.04781 0.00253 0.2584 0.2269 0.1249 0.1180
# Cumulative Proportion 0.1082 0.15603 0.15856 0.4170 0.6439 0.7688 0.8868
#                           PC5     PC6
# Eigenvalue            2.98555 1.08606
# Proportion Explained  0.08304 0.03021
# Cumulative Proportion 0.96979 1.00000
# 
# Accumulated constrained eigenvalues
# Importance of components:
#                         RDA1   RDA2    RDA3
# Eigenvalue            3.8911 1.7189 0.09098
# Proportion Explained  0.6825 0.3015 0.01596
# Cumulative Proportion 0.6825 0.9840 1.00000
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  7.368749 
# 
# 
# Species scores
# 
#                     RDA1    RDA2     RDA3     PC1     PC2     PC3
# Average.LA..m2.  0.44135  0.0172  0.02023  1.9271  0.6515 -2.0059
# SLA..m2.kg.     -0.91891  0.8336  0.06128  0.2435  1.5995  0.3652
# LMA..kg.m2.      1.39171 -0.5405 -0.03705 -0.5203 -1.1255 -0.4488
# LDMC..mg.g.      0.58104 -0.4418 -0.02041  1.5058 -1.3468  1.2119
# Cmass..g.kg.    -0.06863  0.3931 -0.35853  2.7314 -0.5294  0.4692
# Nmass..g.kg.     1.59935  1.1219  0.05390  0.5086  2.4448  0.8582
# 
# 
# Site scores (weighted sums of species scores)
# 
#         RDA1       RDA2      RDA3       PC1       PC2       PC3
# 1   -0.32560  0.3767951  -1.07777 -0.033442  0.007327 -0.071454
# 2    0.02055  0.0667558  -1.33836  0.026566 -0.035789 -0.016395
# 3   -1.23246  2.4837009   3.44361 -0.032838  1.131737  0.543309
# 4   -1.22270 -1.6960783   6.09372 -0.606398 -0.612897 -0.028198
# 5   -1.59601  0.9178564   4.22238 -0.303484  0.376236 -0.065398
# 6   -1.07857 -1.0697498   7.60712 -0.464204 -0.341867  0.061423
# 7    0.04114  0.2246712   2.21207 -0.105537  0.194993  0.083378
# 8   -0.43752 -0.8460859   2.58493 -0.134411 -0.375143 -0.033939
# 9   -0.65573 -1.3289162  -9.43816  0.701893 -0.959890  0.432830
# 10  -0.75458  0.2507858   0.94281 -0.014629  0.407950 -0.505980
# 11  -0.91838 -0.0007141   0.24763  0.063354  0.185907  0.399166
# 12  -0.11591  0.1201342   3.08664  0.058058  0.476676 -0.331456
# 13  -0.39980 -0.0194588  -6.35496  0.448951 -0.056971  0.234345
# 14   0.04302 -0.2005342  -1.92290  0.161084  0.072971  0.156407
# 15   0.23828 -0.0408122  -0.08300  0.086092  0.080591  0.096252
# 16  -0.01484  2.7098406   2.30627  0.052591  1.366889  0.502864
# 17   0.03275  0.0346892   3.18978 -0.072717  0.225311 -0.432200
# 18  -0.09695 -1.0600908  -5.10438  0.274344 -0.708550  0.143423
# 19  -0.07983  0.2333940  -1.16750  0.085233  0.051653  0.075693
# 20   0.06528 -0.2518381  -0.34299  0.015343 -0.205336 -0.043235
# 21   0.32975 -0.0047907  -0.82995 -0.132029 -0.334586  0.027266
# 22   0.01700  0.0679791  -0.90292 -0.028892 -0.270830 -0.192614
# 23   0.06942 -1.1235762  -3.97150  0.206651 -0.974478  0.316061
# 24  -0.17762 -0.0901587   0.11947 -0.081700 -0.239209 -0.183801
# 25  -1.26525 -1.0522202   2.15858 -0.564244 -0.572369 -0.634432
# 26   0.84692 -0.7066043  -3.22668  0.167996 -0.557102 -0.114348
# 27   0.11765 -0.1395521  -3.96668  0.140507 -0.295942 -0.079845
# 28   0.02014  0.0935120  -1.97201 -0.026304 -0.125707 -0.032688
# 29  -1.01987  0.5635655   0.73599 -0.465104  0.279857 -0.184102
# 30   0.26051 -0.5042183  -2.60036  0.035751 -0.266449  0.094675
# 31   0.32351 -0.1332217  -2.12474  0.174724 -0.117280  0.167115
# 32  -0.62377  1.6792237   0.57631 -0.019758  0.778219  0.137636
# 33   0.12976  0.0904649  -1.76176  0.182160  0.034493  0.037089
# 34  -0.65846 -1.3818627   4.56815 -0.437485 -0.254200 -0.133699
# 35  -2.16172  0.5996815   3.30215 -0.384702  0.325620 -0.531455
# 36  -0.72708  2.7631601  11.16885 -1.060159  1.753836 -0.727320
# 37  -0.75934  1.2967722   0.78386  0.085888  0.087493  0.741579
# 38   2.77393  3.4872290  18.43339 -1.756357  1.962733  2.219881
# 39   2.79944 -0.7611378 -11.03431  1.352579 -0.846509  0.044471
# 40   1.53312  2.2822689  -1.42818  0.402334  1.814787 -2.324940
# 41   0.06483 -0.7171526   0.44201  0.679726  0.229662  0.388001
# 42   1.91866 -3.6099872  26.20633 -2.600500 -0.002508 -0.395267
# 43   0.59475 -2.8466923 -13.94619  0.549764 -1.611042  0.212577
# 44   3.06959 -4.0187384  -3.86189 -0.121198 -1.820555  0.251324
# 45   1.94669 -2.7714151  11.09763 -1.309162 -0.441914 -1.446656
# 46  -2.74036  0.2365117   5.67124 -0.863673  0.186089 -0.003264
# 47  -1.47839  0.7866984   5.60619 -0.295896  0.238504 -0.616156
# 51  -0.18489  0.2591616  -0.41608 -0.067953  0.136362 -0.181386
# 63  -0.42274  0.5920584   1.06980 -0.037633  0.608585 -0.069372
# 83   0.94786 -2.6440444 -31.11729  1.897371 -1.641651  1.271381
# 84   2.17236 -3.7308753  -4.01069  1.381154 -0.666648 -4.509123
# 85   2.39220  0.9160968   1.00206 -0.260621  0.756482  1.862005
# 86   0.16224 -0.3684579  10.46858 -0.851618  0.483348  0.757174
# 87   1.38740 -1.1377855  -5.48368  0.887785 -0.503992  2.167975
# 88   3.22502  6.2980243   7.86658 -1.179629  2.291665  0.639820
# 89   1.38014 -0.0521684 -10.86154  1.098267 -1.288396  0.837301
# 90   0.21505 -3.3325665   2.34697 -2.100503 -1.581562 -1.533121
# 91  -1.07771 -5.7507788  -0.86413 -0.258262 -1.478796  0.120787
# 92  -2.56552 -0.5594504   6.74908 -0.221633  1.422864 -0.439280
# 177 -0.06709  0.3173260  -0.94991  0.152012  0.037242  0.166577
# 178 -0.56776  1.0327436   0.67682  0.151707  0.225828  0.308998
# 179 -0.10722  0.5154315  -0.09867  0.099703  0.280390  0.105233
# 180 -0.80297  0.8852601   1.55815 -0.113277 -0.276258  0.207762
# 182 -0.58768  0.8594998  -0.11731  0.150764  0.196570  0.258857
# 183 -0.19364  0.9390398   2.24821 -0.051808  0.426466  0.100033
# 184 -0.13224  0.5977861  -0.40294  0.114161  0.010091  0.086526
# 224  1.85189 -1.3333090  -3.78078  0.432487 -0.136308  0.164664
# 225 -0.66510 -0.0168064  -1.39676  0.085345 -0.028113  0.239008
# 226 -0.16610 -0.6307311  10.11950 -0.650245  0.337440 -1.044930
# 227 -0.56499  0.6971646   0.47159 -0.293987  0.072342 -0.294123
# 229 -0.28310  0.2939120  -1.02426  0.037356 -0.113506  0.137988
# 230 -0.06359  0.1607306  -0.65567 -0.044031 -0.035853 -0.044432
# 231 -0.36686  0.5671180  -1.12831  0.017174 -0.087652 -0.052259
# 232 -0.26078 -0.2301205  -3.12517  0.137986 -0.019771  0.023217
# 233  0.20068 -0.0407672  -1.23780  0.196094 -0.154781  0.118375
# 234 -0.08092 -0.2562765   1.93115 -0.007035 -0.248620 -0.419242
# 235 -0.44706  1.3606134  -5.18817  0.473505  0.047868  0.198572
# 236 -0.22102  0.0499409   0.34759 -0.017277 -0.377184 -0.125386
# 237  0.12927  0.4123143   1.31903 -0.034069 -0.237715 -0.175541
# 242 -0.71757 -1.0935748   3.73620 -0.567330 -0.576054  0.426596
# 243 -1.11989  0.3426014 -11.47280  0.748182 -0.580525  0.662197
# 244 -1.52772  0.5451338  -6.62803  0.285125 -0.433642  0.424536
# 245  2.41410  8.5456722 -10.30124  4.373966  2.891074 -0.635308
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
#          RDA1      RDA2     RDA3       PC1       PC2       PC3
# 1   -0.296841  0.336053 -0.34029 -0.033442  0.007327 -0.071454
# 2   -0.385796  0.129056 -0.41514  0.026566 -0.035789 -0.016395
# 3   -0.890847 -0.097636  0.60162 -0.032838  1.131737  0.543309
# 4   -0.849388  0.165817  0.80213 -0.606398 -0.612897 -0.028198
# 5   -0.785152  0.277781  0.74906 -0.303484  0.376236 -0.065398
# 6   -0.804758  0.198477  0.72521 -0.464204 -0.341867  0.061423
# 7   -0.842424  0.012420  0.60994 -0.105537  0.194993  0.083378
# 8   -0.922239  0.198822  1.07210 -0.134411 -0.375143 -0.033939
# 9   -0.977981 -0.150443  1.13594  0.701893 -0.959890  0.432830
# 10  -0.988800 -0.436691  0.70285 -0.014629  0.407950 -0.505980
# 11  -0.786427 -0.535674 -0.22097  0.063354  0.185907  0.399166
# 12  -0.767841 -0.500241 -0.21897  0.058058  0.476676 -0.331456
# 13  -0.591115 -0.446255 -0.56221  0.448951 -0.056971  0.234345
# 14  -0.636490 -0.479728 -0.53533  0.161084  0.072971  0.156407
# 15  -0.525878 -0.162317 -0.41986  0.086092  0.080591  0.096252
# 16  -0.534581 -0.267677 -0.51006  0.052591  1.366889  0.502864
# 17  -0.437955  0.032335 -0.39968 -0.072717  0.225311 -0.432200
# 18  -0.411324  0.120484 -0.37686  0.274344 -0.708550  0.143423
# 19  -0.362880  0.060619 -0.52819  0.085233  0.051653  0.075693
# 20  -0.337068  0.267985 -0.39695  0.015343 -0.205336 -0.043235
# 21  -0.305641  0.765225 -0.04231 -0.132029 -0.334586  0.027266
# 22  -0.256179  0.725797 -0.22061 -0.028892 -0.270830 -0.192614
# 23  -0.222491  0.686358 -0.34811  0.206651 -0.974478  0.316061
# 24  -0.236281  0.575165 -0.44109 -0.081700 -0.239209 -0.183801
# 25  -0.159650  0.610713 -0.58007 -0.564244 -0.572369 -0.634432
# 26  -0.076910  0.488171 -0.92221  0.167996 -0.557102 -0.114348
# 27  -0.060076  0.337419 -1.14904  0.140507 -0.295942 -0.079845
# 28   0.015594  0.341201 -1.32306 -0.026304 -0.125707 -0.032688
# 29  -0.029750  0.118317 -1.48280 -0.465104  0.279857 -0.184102
# 30  -0.037871  0.019757 -1.59759  0.035751 -0.266449  0.094675
# 31  -0.012786  0.048468 -1.62306  0.174724 -0.117280  0.167115
# 32  -0.026630 -0.002872 -1.65653 -0.019758  0.778219  0.137636
# 33  -0.029128 -0.008057 -1.65635  0.182160  0.034493  0.037089
# 34  -0.396490 -0.412920  0.13772 -0.437485 -0.254200 -0.133699
# 35  -0.050587  0.104922  0.54258 -0.384702  0.325620 -0.531455
# 36   0.165362 -0.112673  0.88302 -1.060159  1.753836 -0.727320
# 37   1.800011  0.622662  0.51510  0.085888  0.087493  0.741579
# 38   1.286697  0.111122  0.60369 -1.756357  1.962733  2.219881
# 39   2.186686  0.229308  0.37719  1.352579 -0.846509  0.044471
# 40   1.066387 -1.154415  0.54847  0.402334  1.814787 -2.324940
# 41   0.913120 -1.606646  0.54617  0.679726  0.229662  0.388001
# 42   1.658137 -1.111139  0.39388 -2.600500 -0.002508 -0.395267
# 43   1.702644 -0.555868  0.43524  0.549764 -1.611042  0.212577
# 44   0.649420 -0.087855  0.76271 -0.121198 -1.820555  0.251324
# 45   0.568677 -0.326635  0.76145 -1.309162 -0.441914 -1.446656
# 46  -0.374174  0.038496  0.81651 -0.863673  0.186089 -0.003264
# 47  -0.138143  0.809434  0.26102 -0.295896  0.238504 -0.616156
# 51  -0.005008  0.096957 -1.59541 -0.067953  0.136362 -0.181386
# 63  -0.348774 -0.563459 -1.44475 -0.037633  0.608585 -0.069372
# 83   0.549129 -1.968671  0.10738  1.897371 -1.641651  1.271381
# 84   1.417444 -1.000018  0.02476  1.381154 -0.666648 -4.509123
# 85   1.278305 -1.302827  0.12977 -0.260621  0.756482  1.862005
# 86   1.647606 -0.893330  0.09510 -0.851618  0.483348  0.757174
# 87   1.278305 -1.302827  0.12977  0.887785 -0.503992  2.167975
# 88   1.682964  1.587902  0.16973 -1.179629  2.291665  0.639820
# 89   1.654819  1.537668  0.16529  1.098267 -1.288396  0.837301
# 90   1.339221  1.057022  0.15364 -2.100503 -1.581562 -1.533121
# 91  -0.850312 -2.564983  0.19621 -0.258262 -1.478796  0.120787
# 92  -1.304547 -3.152611  0.18281 -0.221633  1.422864 -0.439280
# 177 -0.400846  0.114211 -0.01476  0.152012  0.037242  0.166577
# 178 -0.237357  0.363222  0.05129  0.151707  0.225828  0.308998
# 179 -0.329888 -0.124904 -0.52260  0.099703  0.280390  0.105233
# 180  0.610837  1.307166  0.89624 -0.113277 -0.276258  0.207762
# 182 -0.352610  0.193645  0.30244  0.150764  0.196570  0.258857
# 183 -0.383317  0.111835  0.32790 -0.051808  0.426466  0.100033
# 184 -0.370604  0.464760  0.69880  0.114161  0.010091  0.086526
# 224  1.084825 -1.367206  0.05903  0.432487 -0.136308  0.164664
# 225 -0.019827 -0.325662  0.91225  0.085345 -0.028113  0.239008
# 226 -0.009298 -0.324239  0.90956 -0.650245  0.337440 -1.044930
# 227  0.525185  0.764447 -2.10358 -0.293987  0.072342 -0.294123
# 229  0.252019  0.489196 -1.55862  0.037356 -0.113506  0.137988
# 230 -0.107056  0.266247 -0.66308 -0.044031 -0.035853 -0.044432
# 231 -0.060487  0.721616 -0.62111  0.017174 -0.087652 -0.052259
# 232 -0.549622 -0.386927 -0.52823  0.137986 -0.019771  0.023217
# 233 -0.483712  0.255723 -0.44480  0.196094 -0.154781  0.118375
# 234 -0.519213  0.566331  1.11393 -0.007035 -0.248620 -0.419242
# 235 -0.435879  0.647506  1.09937  0.473505  0.047868  0.198572
# 236 -0.218332  0.889065  1.06420 -0.017277 -0.377184 -0.125386
# 237 -0.078977  1.064024  1.04361 -0.034069 -0.237715 -0.175541
# 242 -1.089274  0.383461  0.77987 -0.567330 -0.576054  0.426596
# 243 -1.089274  0.383461  0.77987  0.748182 -0.580525  0.662197
# 244 -1.151443  0.728390  1.19159  0.285125 -0.433642  0.424536
# 245  0.610837  1.307166  0.89624  4.373966  2.891074 -0.635308
# 
# 
# Biplot scores for constraining variables
# 
#                    RDA1     RDA2     RDA3 PC1 PC2 PC3
# MMP..mm.         0.7318 -0.37269  0.57053   0   0   0
# mGDD0....C.      0.3774 -0.92541 -0.03455   0   0   0
# alpha..unitless. 0.2580 -0.09233  0.96172   0   0   0
```


---
## Fitting the RDA: Model examination 


```
# $r.squared
# [1] 0.1585596
# 
# $adj.r.squared
# [1] 0.1266062
#         MMP..mm.      mGDD0....C. alpha..unitless. 
#         6.148742         2.541900         4.014843
```


---
## Fitting the RDA: Model examination 


```
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless., data = ClimateSS[, 2:12])
#          Df Variance      F Pr(&gt;F)    
# Model     3    5.701 4.9622  0.001 ***
# Residual 79   30.254                  
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```




---
## Fitting the RDA: Model examination 


```
# Permutation test for rda under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless., data = ClimateSS[, 2:12])
#                  Df Variance      F Pr(&gt;F)    
# MMP..mm.          1   2.3525 6.1428  0.001 ***
# mGDD0....C.       1   1.3686 3.5737  0.006 ** 
# alpha..unitless.  1   1.9800 5.1702  0.001 ***
# Residual         79  30.2541                  
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```



---
## Fitting the RDA: Model examination 


```
# Permutation test for rda under reduced model
# Forward tests for axes
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = cwm.tab ~ MMP..mm. + mGDD0....C. + alpha..unitless., data = ClimateSS[, 2:12])
#          Df Variance       F Pr(&gt;F)    
# RDA1      1   3.8911 10.1606  0.001 ***
# RDA2      1   1.7189  4.4885  0.007 ** 
# RDA3      1   0.0910  0.2376  0.955    
# Residual 79  30.2541                   
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```




---
## Fitting the RDA: Model examination 

- 2 scalings

0: Similarities between objects 

1: Correlation among variables

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-53-1.png" width="360" style="display: block; margin: auto;" /&gt;


---
## Fitting the RDA: Model examination 

&lt;img src="LectureSlides_files/figure-html/unnamed-chunk-54-1.png" width="360" style="display: block; margin: auto;" /&gt;









    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="R-macros.js"></script>
<script>var slideshow = remark.create({
"highlightLines": true,
"highlightStyle": "github"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
